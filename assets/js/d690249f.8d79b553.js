"use strict";(self.webpackChunkag_tech_mentoring=self.webpackChunkag_tech_mentoring||[]).push([[801],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),h=o,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||i;return n?r.createElement(m,a(a({ref:t},p),{},{components:n})):r.createElement(m,a({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2490:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=n(7462),o=(n(7294),n(3905));const i={sidebar_position:4},a="\u27a1\ufe0f NAT",s={unversionedId:"specialized-topics/networking/concepts/NAT",id:"specialized-topics/networking/concepts/NAT",title:"\u27a1\ufe0f NAT",description:"_",source:"@site/docs/specialized-topics/networking/concepts/NAT.md",sourceDirName:"specialized-topics/networking/concepts",slug:"/specialized-topics/networking/concepts/NAT",permalink:"/ag-tech-mentorship-website/docs/specialized-topics/networking/concepts/NAT",draft:!1,editUrl:"https://github.com/AleksandrGontcharov/ag-tech-mentorship/blob/master/docs/specialized-topics/networking/concepts/NAT.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"\u27a1\ufe0f Routers",permalink:"/ag-tech-mentorship-website/docs/specialized-topics/networking/concepts/routers"},next:{title:"\ue795 ip",permalink:"/ag-tech-mentorship-website/docs/specialized-topics/networking/commands/ip"}},l={},c=[{value:"Configuring SNAT on the router VM",id:"configuring-snat-on-the-router-vm",level:2}],p={toc:c},d="wrapper";function u(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\ufe0f-nat"},"\u27a1\ufe0f NAT"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"NAT, or Network Address Translation, is a networking technique used to map one IP address space to another by modifying the IP addresses in the packet headers as they pass through a routing device, like a router or a firewall. NAT was introduced to help mitigate the exhaustion of IPv4 addresses by allowing multiple devices with private IP addresses to share a single or a few public IP addresses when accessing the internet."),(0,o.kt)("p",null,"There are several types of NAT, including:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"SNAT (Source Network Address Translation): SNAT modifies the source IP address of packets leaving a private network. It allows multiple devices within the private network to share a single public IP address or a pool of public IP addresses when accessing the internet."),(0,o.kt)("li",{parentName:"ol"},"DNAT (Destination Network Address Translation): DNAT modifies the destination IP address of packets arriving from a public network to a private network. It is often used in conjunction with SNAT to facilitate bidirectional communication between public and private networks."),(0,o.kt)("li",{parentName:"ol"},"PAT (Port Address Translation): Also known as NAPT (Network Address and Port Translation), PAT not only translates IP addresses but also translates the source port numbers in the packet headers. This allows multiple devices to share a single public IP address by differentiating their connections based on port numbers."),(0,o.kt)("li",{parentName:"ol"},"1:1 NAT (One-to-One NAT): In this NAT configuration, each private IP address is mapped to a unique public IP address. It provides a more transparent and less complex form of address translation but requires a public IP address for each device, which can be costly and inefficient.")),(0,o.kt)("p",null,"NAT plays a crucial role in conserving the limited IPv4 address space, providing an additional layer of security by hiding the private IP addresses of devices within a network, and facilitating communication between private and public networks."),(0,o.kt)("h2",{id:"configuring-snat-on-the-router-vm"},"Configuring SNAT on the router VM"),(0,o.kt)("p",null,"To set up SNAT for the eth1 subnet so that it can access the internet through eth0, follow these steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Enable IP forwarding on your Ubuntu server:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo sysctl -w net.ipv4.ip_forward=1\n")),(0,o.kt)("p",null,"To make this change permanent, edit the ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/sysctl.conf")," file and add or uncomment the following line:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"net.ipv4.ip_forward=1\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Configure SNAT using iptables:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.0/26 -j MASQUERADE\nsudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.64/26 -j MASQUERADE\nsudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.128/26 -j MASQUERADE\n")),(0,o.kt)("p",null,"This command appends a rule to the POSTROUTING chain of the ",(0,o.kt)("inlineCode",{parentName:"p"},"nat")," table that says: for all packets originating from the 192.168.2.0/26 subnet (eth1) and going out through eth0, apply the MASQUERADE target, which will perform SNAT using the router's public IP address (192.168.1.18 in your case) on eth0."),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Configure the DNS server:")),(0,o.kt)("p",null,"Since I am using DHCP to assign IP addresses to the VMs on the eth1 subnet, I will configure the DHCP server to provide the DNS server information to the clients."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo vim /etc/dhcp/dhcpd.conf\n")),(0,o.kt)("p",null,"Add this to each subnet"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"option domain-name-servers 8.8.8.8;\n")),(0,o.kt)("p",null,"Apply the settings"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo systemctl restart isc-dhcp-server\n")))}u.isMDXComponent=!0}}]);
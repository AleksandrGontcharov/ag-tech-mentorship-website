<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-specialized-topics/networking/progress" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">‚úÖProgress | AG Tech Mentorship</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/docs/specialized-topics/networking/progress"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="‚úÖProgress | AG Tech Mentorship"><meta data-rh="true" name="description" content="Prerequisite: Set up Hyper-V."><meta data-rh="true" property="og:description" content="Prerequisite: Set up Hyper-V."><link data-rh="true" rel="icon" href="/ag-tech-mentorship-website/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/docs/specialized-topics/networking/progress"><link data-rh="true" rel="alternate" href="https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/docs/specialized-topics/networking/progress" hreflang="en"><link data-rh="true" rel="alternate" href="https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/docs/specialized-topics/networking/progress" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"‚úÖProgress","item":"https://aleksandrgontcharov.github.io/ag-tech-mentorship-website/docs/specialized-topics/networking/progress"}]}</script><link rel="stylesheet" href="/ag-tech-mentorship-website/assets/css/styles.5d4a5f10.css">
<script src="/ag-tech-mentorship-website/assets/js/runtime~main.f7f7f0de.js" defer="defer"></script>
<script src="/ag-tech-mentorship-website/assets/js/main.fdea7580.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ag-tech-mentorship-website/"><div class="navbar__logo"><img src="/ag-tech-mentorship-website/img/ag-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ag-tech-mentorship-website/img/ag-logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AG Tech Mentorship</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ag-tech-mentorship-website/docs/intro">Start Here</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ag-tech-mentorship-website/docs/intro"><span title="Welcome" class="linkLabel_WmDU">Welcome</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/ag-tech-mentorship-website/docs/foundational-program/computer-setup/computer-setup"><span title="Foundational Program" class="categoryLinkLabel_W154">Foundational Program</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/ag-tech-mentorship-website/docs/category/-javascript"><span title="Programming Languages" class="categoryLinkLabel_W154">Programming Languages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/networking-syllabus"><span title="Specialized Topics" class="categoryLinkLabel_W154">Specialized Topics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/networking-syllabus"><span title="Ôõø Networking" class="categoryLinkLabel_W154">Ôõø Networking</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/networking-syllabus"><span title="üìúNetworking Syllabus" class="linkLabel_WmDU">üìúNetworking Syllabus</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/progress"><span title="‚úÖProgress" class="linkLabel_WmDU">‚úÖProgress</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/vm-setup"><span title="üñ•Ô∏èVM Setup" class="linkLabel_WmDU">üñ•Ô∏èVM Setup</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/concepts/osi-model"><span title="üí°Concepts" class="categoryLinkLabel_W154">üí°Concepts</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/commands/ip"><span title="üìüCommands" class="categoryLinkLabel_W154">üìüCommands</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/authentication/oidc-flows"><span title="ÔÄ£ Authentication" class="categoryLinkLabel_W154">ÔÄ£ Authentication</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ag-tech-mentorship-website/docs/specialized-topics/cybersecurity/Foundations of Cybersecurity/Week 1/introduction-to-cybersecurity"><span title="Ôîë Cybersecurity" class="categoryLinkLabel_W154">Ôîë Cybersecurity</span></a></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ag-tech-mentorship-website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Specialized Topics</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ôõø Networking</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">‚úÖProgress</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>‚úÖProgress</h1></header>
<p><strong>Prerequisite:</strong> Set up Hyper-V.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-virtual-hardware">Create the virtual hardware<a href="#create-the-virtual-hardware" class="hash-link" aria-label="Direct link to Create the virtual hardware" title="Direct link to Create the virtual hardware" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-switches">Create the switches<a href="#create-the-switches" class="hash-link" aria-label="Direct link to Create the switches" title="Direct link to Create the switches" translate="no">‚Äã</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->Create 3 private virtual switches called <code>red</code>, <code>green</code>, <code>blue</code></li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->Create a switch called <code>external</code> that public and connect it your home network</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-vms">Create the VMs<a href="#create-the-vms" class="hash-link" aria-label="Direct link to Create the VMs" title="Direct link to Create the VMs" translate="no">‚Äã</a></h3>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""> <!-- -->Create 6 VMs <code>{red,green,blue}-{a,b}</code> [e.g. <code>red-a</code>, <code>red-b</code>, <code>green-a</code>,‚Ä¶.] and connect them to the appropriate switches.</p>
<ul>
<li class="">Use UI-less (server) ubuntu SKU¬† (choose last LTS)</li>
<li class="">without DHCP</li>
<li class="">Verify that they indeed <strong>fail</strong> to acquire IP address, as there‚Äôs no DHCP</li>
</ul>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""> <!-- -->Create 1 VM called <code>router</code> and connect it all the switches</p>
<ul>
<li class="">Verify that the router gets an IP address can access the internet<!-- -->
<ul>
<li class=""><code>ping google.com</code></li>
<li class=""><code>ip addr show</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-settings-for-dhcp">Create the settings for dhcp<a href="#create-the-settings-for-dhcp" class="hash-link" aria-label="Direct link to Create the settings for dhcp" title="Direct link to Create the settings for dhcp" translate="no">‚Äã</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->configure <code>dhcp</code> server to allocate IPs for other client-vms</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="networking-diagram">Networking diagram<a href="#networking-diagram" class="hash-link" aria-label="Direct link to Networking diagram" title="Direct link to Networking diagram" translate="no">‚Äã</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="router-settings">Router settings<a href="#router-settings" class="hash-link" aria-label="Direct link to Router settings" title="Direct link to Router settings" translate="no">‚Äã</a></h3>
<p>These settings on my router allow it to be configured as a dhcp server</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>sudo vim /etc/netplan/00-installer-config.yaml</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">network:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  version: 2</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  renderer: networkd</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  ethernets:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    eth0:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      dhcp4: true</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    eth1: # RED NETWORK</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      addresses:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        - 192.168.2.1/26</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      nameservers:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        addresses: [127.0.0.1]</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      routes:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        - to: 127.0.0.1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          via: 192.168.2.1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    eth2: # GREEN NETWORK</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      addresses:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        - 192.168.2.65/26</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      nameservers:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        addresses: [127.0.0.1]</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      routes:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        - to: 127.0.0.1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          via: 192.168.2.65</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    eth3: # BLUE NETWORK</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      addresses:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        - 192.168.2.129/26</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      nameservers:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        addresses: [127.0.0.1]</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      routes:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        - to: 127.0.0.1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          via: 192.168.2.129</span><br></span></code></pre></div></div></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>sudo vim /etc/dhcp/dhcpd.conf</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">default-lease-time 600;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">max-lease-time 7200;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">ddns-update-style none;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">authoritative;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># RED</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">subnet 192.168.2.0 netmask 255.255.255.192 {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  range 192.168.2.2 192.168.2.62;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option routers 192.168.2.1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option domain-name-servers 127.0.0.1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  interface eth1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># GREEN</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">subnet 192.168.2.64 netmask 255.255.255.192 {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  range 192.168.2.66 192.168.2.126;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option routers 192.168.2.65;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option domain-name-servers 127.0.0.1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  interface eth2;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># BLUE</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">subnet 192.168.2.128 netmask 255.255.255.192 {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  range 192.168.2.130 192.168.2.190;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option routers 192.168.2.129;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option domain-name-servers 127.0.0.1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  interface eth3;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre></div></div></div></div></details>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="client-vm-settings-red-a-red-b-etc">Client VM settings (red-a, red-b etc.)<a href="#client-vm-settings-red-a-red-b-etc" class="hash-link" aria-label="Direct link to Client VM settings (red-a, red-b etc.)" title="Direct link to Client VM settings (red-a, red-b etc.)" translate="no">‚Äã</a></h3>
<p>These settings on my router allow it to be configured as a dhcp server</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>sudo vim /etc/dhcp/dhcpd.conf</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">network:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  version: 2</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  ethernets:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    eth0:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      dhcp4: true</span><br></span></code></pre></div></div></div></div></details>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="configure-nat">Configure NAT<a href="#configure-nat" class="hash-link" aria-label="Direct link to Configure NAT" title="Direct link to Configure NAT" translate="no">‚Äã</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->Configure NAT (specifically SNAT) on the router so VMs can reach internet. U can use 8.8.8.8 as a DNS server for now (Google&#x27;s public dns) or your ISP dns (or your home router)</li>
</ul>
<p>Explanation for eth1.
I have configured SNAT on your Ubuntu server acting as a router. The essential configuration for SNAT is the iptables rule:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.0/26 -j MASQUERADE</span><br></span></code></pre></div></div>
<p>This rule performs SNAT for the 192.168.2.0/26 subnet (eth1), allowing VMs on this subnet to access the internet through the router&#x27;s eth0 interface.</p>
<ul>
<li class=""><code>-t nat</code>: Specifies the &#x27;nat&#x27; table, where rules for address translation are stored.</li>
<li class=""><code>-A POSTROUTING</code>: Appends a rule to the POSTROUTING chain, which is responsible for modifying the source address of packets after the routing decision has been made.</li>
<li class=""><code>-o eth0</code>: Matches packets that are going out through the eth0 interface (connected to the internet).</li>
<li class=""><code>-s 192.168.2.0/26</code>: Matches packets originating from the 192.168.2.0/26 subnet (eth1).</li>
<li class=""><code>-j MASQUERADE</code>: The target action to perform when the rule matches. The MASQUERADE target performs SNAT, replacing the source IP address of the packets with the router&#x27;s public IP address (in this case, the IP address of the eth0 interface).</li>
</ul>
<p>In summary, this rule tells iptables to perform Source Network Address Translation (SNAT) for packets originating from the 192.168.2.0/26 subnet (eth1) and going out through the eth0 interface (connected to the internet). This allows VMs on the eth1 subnet to access the internet using the router&#x27;s public IP address as the source address for their packets, effectively hiding their private IP addresses from the external network.</p>
<p>Additionally, I have set up a DHCP server that assigns IP addresses to the VMs on the eth1 subnet and provides them with the DNS server information (8.8.8.8). These settings, along with the SNAT rule, enable the VMs on the eth1 subnet to access the internet using your Ubuntu server as a router.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>sudo vim /etc/dhcp/dhcpd.conf</summary><div><div class="collapsibleContent_i85q"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">default-lease-time 600;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">max-lease-time 7200;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">ddns-update-style none;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">authoritative;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># RED</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">subnet 192.168.2.0 netmask 255.255.255.192 {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  range 192.168.2.2 192.168.2.62;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option routers 192.168.2.1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option domain-name-servers 8.8.8.8;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  interface eth1;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># GREEN</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">subnet 192.168.2.64 netmask 255.255.255.192 {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  range 192.168.2.66 192.168.2.126;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option routers 192.168.2.65;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option domain-name-servers 8.8.8.8;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  interface eth2;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># BLUE</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">subnet 192.168.2.128 netmask 255.255.255.192 {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  range 192.168.2.130 192.168.2.190;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option routers 192.168.2.129;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  option domain-name-servers 8.8.8.8;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  interface eth3;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre></div></div></div></div></details>
<p>Notes on <code>sudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.0/26 -j MASQUERADE</code></p>
<p>What is the POSTROUTING chain. Why is it called a CHAIN, what is it in the context of?</p>
<p>In the context of iptables, a chain is a series of rules that are sequentially checked against packets. When a packet matches a rule in a chain, the specified action (called a &quot;target&quot;) is performed on the packet. If no rule matches the packet, it follows the default policy set for that chain.</p>
<p>Iptables organizes chains into tables, where each table serves a specific purpose. In the case of NAT, the table used is the &quot;nat&quot; table. Within the nat table, there are three built-in chains:</p>
<ol>
<li class="">PREROUTING: Processes packets as they arrive at the router, before the routing decision is made. PREROUTING is typically used for Destination Network Address Translation (DNAT).</li>
<li class="">INPUT: Processes packets that are destined for the router itself.</li>
<li class="">OUTPUT: Processes packets generated by the router.</li>
<li class="">FORWARD: Processes packets that are being routed through the router to other devices.</li>
<li class="">POSTROUTING: Processes packets after the routing decision has been made, just before they leave the router. POSTROUTING is typically used for Source Network Address Translation (SNAT).</li>
</ol>
<p>The POSTROUTING chain is where rules for modifying the source address of packets are applied after the routing decision. It allows the router to perform SNAT, translating the source IP addresses of packets from private IP addresses to the router&#x27;s public IP address. This is crucial for allowing devices with private IP addresses to access the internet, as the router&#x27;s public IP address is used as the source address for their packets, effectively hiding their private IP addresses from the external network.</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->Use iptables to block internet access for the red network</li>
</ul>
<p>In order to do this, we modify the FORWARD table of <code>iptables</code> with</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth1 -s 192.168.2.1/26 ! -d 192.168.0.0/16 -j DROP</span><br></span></code></pre></div></div>
<p>This command appends (<code>-A</code>) a rule to the FORWARD chain that matches packets coming in from the eth1 interface (<code>-i eth1</code>) with a source IP address in the 192.168.2.1/26 subnet (<code>-s 192.168.2.1/26</code>). The <code>-j DROP</code> target specifies that the action for matched packets is to drop them.</p>
<p>After running this command, the Ubuntu router will drop all packets from the eth1 subnet destined for the internet.</p>
<p>Remember that this rule will be lost if the system is rebooted or the iptables service is restarted. To save the current iptables rules and ensure they persist after a reboot, you can use the <code>iptables-persistent</code> package, as mentioned in a previous response.</p>
<p>How do I make it persistent after reboot?</p>
<p>install the <code>iptables-persistent</code> service</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo apt-get install iptables-persistent</span><br></span></code></pre></div></div>
<p>The <code>iptables-persistent</code> service loads the saved rules automatically during system startup. However, you can also start, stop, or restart the service manually using these commands:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo systemctl start netfilter-persistent</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo systemctl stop netfilter-persistent</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo systemctl restart netfilter-persistent</span><br></span></code></pre></div></div>
<p>Always run this command after changing the rules</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo netfilter-persistent save</span><br></span></code></pre></div></div>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->Use your iptables policy to deny(or drop) -by default and use explicit allow-listing for everything. Ensure everything continues to work (DHCP, SNAT, etc).</li>
</ul>
<p>In order to do this</p>
<ol start="0">
<li class="">Clear all existing rules</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -F</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -X</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -t nat -F</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -t nat -X</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo netfilter-persistent save</span><br></span></code></pre></div></div>
<p>The commands above flush (-F) all existing rules, delete (-X) any user-defined chains, and set the default policies for INPUT, OUTPUT, and FORWARD chains to ACCEPT. This ensures that we start with a clean slate and all traffic is allowed by default.</p>
<ol>
<li class="">Set the default policy for the FORWARD chain to DROP:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -P FORWARD DROP</span><br></span></code></pre></div></div>
<p>The commands above set the default policy for the FORWARD chain to DROP, meaning all traffic will be dropped unless explicitly allowed.</p>
<ol start="2">
<li class="">Allow traffic between eth1, eth2, and eth3:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth1 -o eth2 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth2 -o eth1 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth1 -o eth3 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth3 -o eth1 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth2 -o eth3 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth3 -o eth2 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol start="3">
<li class="">Enable IP forwarding:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">echo &quot;net.ipv4.ip_forward=1&quot; | sudo tee -a /etc/sysctl.conf</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo sysctl -p</span><br></span></code></pre></div></div>
<ol start="4">
<li class="">Configure SNAT for eth1, eth2, and eth3 to use eth0 as a gateway to the internet. Replace <code>your_public_ip</code> with the public IP address of eth0:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.0/26 -j SNAT --to-source your_public_ip</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.64/26 -j SNAT --to-source your_public_ip</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -t nat -A POSTROUTING -o eth0 -s 192.168.2.128/26 -j SNAT --to-source your_public_ip</span><br></span></code></pre></div></div>
<p>These commands set up SNAT to translate the source IP addresses of the VMs connected to eth1, eth2, and eth3 to your public IP address when they access the internet. The -t nat flag specifies that we are working with the NAT table, and the POSTROUTING chain is where we add the SNAT rules.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>note that your_public_ip in this case will be the IP assigned to eth0, and would not be your actual public ip.</p></div></div>
<ol start="5">
<li class="">Allow traffic from the internet to reach eth1, eth2, and eth3 through eth0 (assuming SNAT is configured):</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth0 -o eth1 -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth0 -o eth2 -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth0 -o eth3 -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br></span></code></pre></div></div>
<p>These commands allows incoming traffic from the internet to eth1, eth2 and eth3 if it&#x27;s part of an established or related connection.</p>
<ol start="6">
<li class="">Allow traffic from eth1, eth2, and eth3 to use eth0 as a gateway to the internet:</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth1 -o eth0 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth2 -o eth0 -j ACCEPT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">sudo iptables -A FORWARD -i eth3 -o eth0 -j ACCEPT</span><br></span></code></pre></div></div>
<p>These rules will explicitly allow the desired traffic between eth1, eth2, eth3, and eth0, while disallowing all other traffic by default due to the DROP policy set for the FORWARD chain.</p>
<p>If you have <code>iptables-persistent</code> installed, don&#x27;t forget to save the changes:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">sudo netfilter-persistent save</span><br></span></code></pre></div></div>
<p>This will make the new configuration persistent across reboots.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/AleksandrGontcharov/ag-tech-mentorship/blob/master/docs/specialized-topics/networking/progress.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/networking-syllabus"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">üìúNetworking Syllabus</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ag-tech-mentorship-website/docs/specialized-topics/networking/vm-setup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">üñ•Ô∏èVM Setup</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-the-virtual-hardware" class="table-of-contents__link toc-highlight">Create the virtual hardware</a><ul><li><a href="#create-the-switches" class="table-of-contents__link toc-highlight">Create the switches</a></li><li><a href="#create-the-vms" class="table-of-contents__link toc-highlight">Create the VMs</a></li></ul></li><li><a href="#create-the-settings-for-dhcp" class="table-of-contents__link toc-highlight">Create the settings for dhcp</a><ul><li><a href="#networking-diagram" class="table-of-contents__link toc-highlight">Networking diagram</a></li><li><a href="#router-settings" class="table-of-contents__link toc-highlight">Router settings</a></li><li><a href="#client-vm-settings-red-a-red-b-etc" class="table-of-contents__link toc-highlight">Client VM settings (red-a, red-b etc.)</a></li></ul></li><li><a href="#configure-nat" class="table-of-contents__link toc-highlight">Configure NAT</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Mentorship</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ag-tech-mentorship-website/docs/intro">Introduction</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/AleksandrGontcharov/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto: alexgoncharov@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 AG Tech Mentorship, Inc.</div></div></div></footer></div>
</body>
</html>